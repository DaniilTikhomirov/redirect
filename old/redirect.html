<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏</title>
    <link id="themeStylesheet" rel="stylesheet" href="redirect.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RNMM82Z6N0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-RNMM82Z6N0');
    </script>
    <script>
        window.onload = function () {
            const button = document.getElementById('dynamicButton');
            const currentPath = window.location.search; // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL

            // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä "name" –∏–∑ —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
            const urlParams = new URLSearchParams(currentPath);
            const name = urlParams.get('name');
            const now = new Date();
            const hours = now.getHours();
            const themeStylesheet = document.getElementById('themeStylesheet');
            const copyButton = document.getElementById('copyButton');
            const dynamicButton = document.getElementById('dynamicButton')

            console.log(name)
            console.log(hours)


            // –°–æ–∑–¥–∞–µ–º Map —Å –∏–º–µ–Ω–∞–º–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å—Å—ã–ª–∫–∞–º–∏
            const linkMapDay = new Map([
                ['nikolaev', 'https://xr.mix-ar.ru/q?id=2776'],
                ['gagarin', 'http://example.com/gagarin'],
                ['turing', 'http://example.com/turing']
            ]);

            const linkMapNight = new Map([
                ['nikolaev', 'https://xr.mix-ar.ru/q?id=2912'],
                ['gagarin', 'http://example.com/gagarin'],
                ['turing', 'http://example.com/turing']
            ])

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–º—è –≤ Map
            if ((hours >= 6 && hours < 20) && linkMapDay.has(name)) {
                button.href = linkMapDay.get(name);  // –ë–µ—Ä–µ–º —Å—Å—ã–ª–∫—É –∏–∑ Map
                button.textContent = `–û–∂–∏–≤–∏—Ç—å –ø–∞–º—è—Ç–Ω–∏–∫`;
            }else if((hours <= 6 || hours >= 20) && linkMapNight.has(name)){
                button.href = linkMapNight.get(name);  // –ë–µ—Ä–µ–º —Å—Å—ã–ª–∫—É –∏–∑ Map
                button.textContent = `–û–∂–∏–≤–∏—Ç—å –ø–∞–º—è—Ç–Ω–∏–∫`;
            }else {
                button.href = '#';
                button.textContent = '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Å—Å—ã–ª–∫–∞';
            }

            copyButton.addEventListener('click', function () {
                const link = window.location.href;
                navigator.clipboard.writeText(link).then(() => {
                    copyButton.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!";
                    setTimeout(() => {
                        copyButton.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É";
                    }, 2000);
                }).catch(err => {
                    console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è', err);
                });

                gtag('event', 'click', {
                    'event_category': 'AR Button',
                    'event_label': 'nikolaev',  // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –ª—é–±–æ–µ –∏–º—è
                    'value': new Date().getHours()  // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤—Ä–µ–º—è –∏–ª–∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ
                });
            });
            dynamicButton.addEventListener('click', function () {
                gtag('event', 'click', {
                    'event_category': 'AR Button',
                    'event_label': 'nikolaev',  // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –ª—é–±–æ–µ –∏–º—è
                    'value': new Date().getHours()  // –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤—Ä–µ–º—è –∏–ª–∏ –¥—Ä—É–≥–∏–µ –¥–∞–Ω–Ω—ã–µ
                });
            })

        }
    </script>
</head>
<body>
<p id="iosMessage" class="ios-warning">
    üî• –ï—Å–ª–∏ —É –≤–∞—Å iPhone, –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ —ç—Ç–æ—Ç —Å–∞–π—Ç —á–µ—Ä–µ–∑ <b>Safari</b> –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã! üì±
</p>

<a id="dynamicButton" href="#" class="btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</a>
<button id="copyButton" class="btn copy-btn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
<script>
    function createStars() {
        const starsContainer = document.createElement("div");
        starsContainer.classList.add("stars");
        document.body.appendChild(starsContainer);

        for (let i = 0; i < 100; i++) { // 100 –∑–≤—ë–∑–¥
            const star = document.createElement("div");
            star.classList.add("star");

            // –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ
            star.style.top = Math.random() * 100 + "vh";
            star.style.left = Math.random() * 100 + "vw";

            // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –º–µ—Ä—Ü–∞–Ω–∏—è
            star.style.animationDelay = Math.random() * 5 + "s";

            starsContainer.appendChild(star);
        }
    }

    if (new Date().getHours() >= 20 || new Date().getHours() < 6) {
        createStars(); // –ó–∞–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∑–≤—ë–∑–¥ —Ç–æ–ª—å–∫–æ –Ω–æ—á—å—é
    }
</script>

</body>
</html>
